name: "Body: HTML contains variables matching Operation Texonto reporting"
description: |
  Analyze raw html text found in the email body to determine if they contain a series of reported variables reported to be used by Operation Texonto.
   - client_id=[redacted]
   - redirect_uri=https%3a%2f%2foutlook.office365.com%2fowa%2f&amp;
   - resource=[redacted]
   - client-request-id=[redacted]
   - domain_hint=[redacted]
   - nonce=[redacted]
   - state=[redacted]

  According to ESET Research on February 21, 2024, malicious activity tracked under the identifier 
  Operation Texonto "targeted a Ukraininan defense company in October 2023 and an EU Agency in November 2023" for
  the purpose of Microsoft Office 365 credential harvesting. The October 2023 emails purported to be from the IT department 
  of the company and sent Ukrainian language emails containing a link to a fake microsoft domain. 
  
references:
  - "https://www.welivesecurity.com/en/eset-research/operation-texonto-information-operation-targeting-ukrainian-speakers-context-war/"
severity: "high"
source: |
  type.inbound and 
    strings.icontains(body.html.raw,"client_id=")
    and strings.icontains(body.html.raw,"redirect_uri=")
    and strings.icontains(body.html.raw, "resource=")
    and strings.icontains(body.html.raw, "client-request-id=")
    and strings.icontains(body.html.raw, "domain_hint=")
    and strings.icontains(body.html.raw, "nonce=")
    and strings.icontains(body.html.raw, "state=")

attack_types:
  - "Credential phishing"
tactics_and_techniques:
  - "Social engineering"
detection_methods:
  - "HTML Analysis"
id: ""

#Created from template.yml for ease of use with the more repetitive aspects of rule creation.
